<!DOCTYPE HTML>

<html>
	
<head>
<title>Tutorial Pair distance distribution</title>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
<link rel="stylesheet" href="../assets/css/main.css" />
<noscript><link rel="stylesheet" href="../assets/css/noscript.css" /></noscript>
</head>

<body class="is-preload">

<div id="wrapper">

<div id="main">

<div class="inner">

<h4><a href="../index.html">Home</a></h4>
<h1>Tutotial: Pair distance distribution, p(r)</h1>
<p> Tutorial contributors: Andreas Haahr Larsen</p>
<p> Frontpage image from <a href="https://nbi.ku.dk/english/theses/phd-theses/phd_theses_2018/andreas_haahr_larsen/Thesis_AndreasHLarsenSept2018.pdf" target="_blank">Larsen 2018 (PhD Thesis)</a></p>

	<!--
<h4>Before you start</h4>
	<ul>
	<li>Download and install <a href="https://www.sasview.org">SasView</a> (needed for Part 2 and 3)</li>
	</ul>
	-->

<h4>Learning outcomes</h4>
	<ul>
	<li>Learn to use and interpret the pair distance distributions.</li>	
	</ul>

<h4>Introductory remarks</h4>
	<p>SAS data is measured in "reciprocal space", i.e. as funciton of 1/length. By a Fourier transformation, one can get a distribution of distances between scattering pairs in the sample (weighted by contrast): the pair distance distribuion or simply the "p(r)" (colloquially denoted the "p-of-r-function").</p>
	<p>The p(r) is in "real space", i.e. as function of length, so it can be interpreted more intuitively than the data itself. The p(r) provides useful structural information about the sample prior to any modelling.</p>

<h4>Part 1: Fourier tranformation </h4>
    <p>In this part you will understand the basics math of Fourier tranformation that is used to generate the pair distance distribution from SAS data</p>
    <p>In order to understand the basics, solve excersizes at <a href="https://pan-learning.org/wiki/index.php/Problem:Fourier_transform" target="_blank">pan-learning.org</a></p>
	<p>These are simple 1D examples, but the math is the same for more realistic samples.</p>
	<p>Note that a p(r) is generated by an <a href="https://en.wikipedia.org/wiki/Indirect_Fourier_transform" target="_blank">Indirect Fourier transformation</a>, but the details of this will not be covered here.</p>

<h4>Part 2: Pair distribution function for various shapes</h4>
	<p>Go to: <a href="https://somo.chem.utk.edu/shape2sas/" target="_blank">Shape2SAS</a>, and simulate a sphere with radius of 50 Å as Model 1 and a 30 Å sphere as Model 2.</p>
	<img src="Shape2SAS-spheres.png" style="width:1000px"/>
	<p>Could you guess the shape (sphere) directly from the p(r)? Notice the inverse relationship with the scattering: large R -> features at low q. How would the p(r) look for an ellipsoid? or a cylinder? Try to calculate the p(r) for various shapes. </p>

<h4>Part 3: Pair distribution function from SAXS/SANS data</h4>
	<p>Download the simulated data of the sphere with radius of 50 Å, which you generated with <a href="https://somo.chem.utk.edu/shape2sas/" target="_blank">Shape2SAS</a>. <a href="Isim.dat">(example data)</a></p>
	<p>Go to <a href="https://somo.chem.utk.edu/bayesapp/">BayesApp</a>, which is a web-application for generating pair distance distributions for SAXS and SANS data.</p>
	<p>Upload your simulated data, give an estimate of the maximum distance (giving an estimate of the maximum distance is optional, but makes BayesApp faster and more robust). Press submit</p>
	<p>The program shows the calculated p(r), and a fit to the data, which was used to generate this p(r).</p>
	<img src="BayesApp_sphere_pr.png" style="width:500px"/>
	<img src="BayesApp_sphere_Iq.png" style="width:500px"/>
    <p>Go to the SAS biological data bank <a href="https://www.sasbdb.org" target="_blank">(SASBDB)</a> and download the SAXS data of the protein Xylanase <a href="https://www.sasbdb.org/data/SASDPS4/" target="_blank">(SASBDB entry SASDPS4)</a>: <a href="SASDPS4.dat" target="_blank">SASDPS4.dat</a></p>
	<p>Use <a href="https://somo.chem.utk.edu/bayesapp/" target="_blank">BayesApp</a> to calculate the p(r) (optionally provide an estimate of the maximum distance). </p> 
	<p>Comment on the resulting p(r) and compare with the shape of the protein as seen at the <a href="https://www.sasbdb.org/data/SASDPS4/" target="_blank">SASBDB entry</a>.

<h4>Part 4: Inhomogeneous particles</h4>
	<p>The p(r) is a contrast-weighted pair distribution (contrast = &Delta;SLD = excess scattering length density). I.e. each bin in the distribution is the weighted sum of all pairs with a given distance.</p> 
	<p>Therefore, if a pair of scatterers have contrasts with the same sign, then they contribute positively, but if the signs are opposite, then their contribution to the p(r) is negative. This means that the p(r) can have negative values</p>
	<p>Go to <a href="https://somo.chem.utk.edu/shape2sas/" target="_blank">Shape2SAS</a>, and simulate a core-shell sphere with inner radius 40 Å and outer radius 50 Å and with core &Delta;SLD of -1 and shell &Delta;SLD of +1
	<img src="SasView_CoreShell1.png" style="width:1000px"/>
	<img src="SasView_CoreShell2.png" style="width:1000px"/>
	<p>What scattering pairs does the negative part of the p(r) represent? What distances do the two positive parts of the p(r) represent? The forward scattering I(0) is about 0. How does that relate to the p(r)? (<a href="hint1.html">Hint</a>)
	<p>Download the simulated data <a href="Isim_coreshell.dat" target="_blank">(example data)</a> and upload it to <a href="https://somo.chem.utk.edu/bayesapp/" target="_blank">BayesApp</a>. Give an estimate of the maximum distance and press Submit. </p>
	<p>Set the tranformation to Negative (to allow p(r) to be negative). Per default, BayesApp uses a positivety constraint, but that should be disabled here.</p>
	<p>Compare with the true p(r) (in <a href="https://somo.chem.utk.edu/shape2sas/" target="_blank">Shape2SAS</a>). You may want to run <a href="https://somo.chem.utk.edu/bayesapp/" target="_blank">BayesApp</a> with positive constraint (default), just to see it fail.</p>

<h4>Part 5: Protein aggregation</h4>
	<p>Protein aggregation in a sample may be detected using p(r) - in reveals itself as a "tail" towards high values of r.</p>
	<p>Go to <a href="https://somo.chem.utk.edu/shape2sas/" target="_blank">Shape2SAS</a>, and simulate a 50 Å sphere (or any other object) with aggregate structure factor (set fraction to 0.005, i.e. 0.5% of all particles are aggregated and particles per aggregate to 40).</p>
	<p>OBS: The p(r) shown in Shape2SAS is for the spheres without the structure factor.</p>	 
	<p>Download the data <a href="Isim_sphere_aggregate.dat">(example data)</a> and calculate the p(r) with <a href="https://somo.chem.utk.edu/bayesapp/" target="_blank">BayesApp</a>. (The default number of points in p(r) may need to be increased). Notice the "tail":
	<img src="BayesApp_agg_pr.png" style="width:500px"/>
	<img src="BayesApp_agg_Iq.png" style="width:00px"/>			

<h4><a href="../index.html">Home</a></h4>

<!-- end inner -->
</div>
	
<!-- end main -->´
</div>

<!-- end wrapper -->´
</div>
	
<!-- Scripts -->
<script src="../assets/js/jquery.min.js"></script>
<script src="../assets/js/browser.min.js"></script>
<script src="../assets/js/breakpoints.min.js"></script>
<script src="../assets/js/util.js"></script>
<script src="../assets/js/main.js"></script>
</body>	
</html>
