<!DOCTYPE HTML>

<html>
	
<head>
<title>Tutorial Pair distance distribution</title>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
<link rel="stylesheet" href="../assets/css/main.css" />
<noscript><link rel="stylesheet" href="../assets/css/noscript.css" /></noscript>
</head>

<body class="is-preload">

<div id="wrapper">

<div id="main">

<div class="inner">

<h4><a href="../index.html">Home</a></h4>
<h1>Tutorial: Pair distance distribution, p(r)</h1>
<p> Tutorial contributors: Andreas Haahr Larsen</p>

<h4>Learning outcomes</h4>
	<ul>
	<li>Be able to generate the pair distance distribution, p(r), from a SAXS or SANS dataset.</li>	
	<li>Recognize geometrical objects from their p(r).</li>
	<li>Mention circumstances can lead to a negative p(r).</li>
	<li>Detect aggregation from the shape of the p(r).</li>
	</ul>

<h4>Introductory remarks</h4>
	<p>
	SAS data is measured in "reciprocal space", i.e. as function of 1/length. By a Fourier transformation, one can get a distribution of distances between scattering pairs in the sample (weighted by contrast): the pair distance distribuion or simply the "p(r)" (colloquially denoted the "p-of-r-function").<br>
	The p(r) is in "real space", i.e. as function of length, so it can be interpreted more intuitively than the data itself. The p(r) provides useful structural information about the sample prior to any modelling.<br>
    This is a practical tutorial, but if you wish to get a better understanding of the theory, it is recommended that you work with the exercises at <a href="https://pan-learning.org/wiki/index.php/Problem:Fourier_transform" target="_blank">pan-learning.org</a>, covering some simple examples.<br>
	SAXS or SANS data can generally not be Fourier transformed directly for the following reasons: (1) Data is measured in a limited range and not from minus infinity to plus infinity (2) Data is noisy. Therefore, the p(r) is generated by an <a href="https://en.wikipedia.org/wiki/Indirect_Fourier_transform" target="_blank">Indirect Fourier transformation (IFT) </a>.
	Various IFT algorithms are implemented and can be accessed through different <a href="programs.html" target="_blank">software packages</a>. In this tutorial, we will use <a href="https://somo.chem.utk.edu/bayesapp/" target="_blank">BayesApp</a>.
	</p>
<h4>Part 1: Recognizing shapes from the pair distribution, p(r)</h4>
	<p>
	Go to: <a href="https://somo.chem.utk.edu/shape2sas/" target="_blank">Shape2SAS</a>, and simulate a sphere with radius of 50 Å as Model 1 and a 30 Å sphere as Model 2.<br>
	<img src="Shape2SAS-spheres1.png" style="width:1000px"/><br>
	Shape2SAS plots the p(r) (lef), the normalized scattering (middle panel) and simulated data (right panel):<br>
	<img src="Shape2SAS-spheres2.png" style="width:1000px"/><br>
	Can you guess from the shapes of the p(r) functions which one represents the larger which one represents the smaller spheres?.<br>
	For homogeneous particles (i.e., having the same contrast in the whole particle), p(r) is the probability distribution of distances between pairs of scatterers in the particle. What is the most frequent distance? What is the largest distance? The largest distance is denoted the d<sub>max</sub>. 
	Try to guess how the p(r) look for an ellipsoid and or for a cylinder or an a hollow sphere. Calculate the p(r) for these and other shapes using <a href="https://somo.chem.utk.edu/shape2sas/" target="_blank">Shape2SAS</a>.
	</p>

<h4>Part 2: Calculating the pair distribution, p(r), from SAXS/SANS data</h4>
	<p>
	Download the simulated data of the sphere with radius of 50 Å, which you generated with <a href="https://somo.chem.utk.edu/shape2sas/" target="_blank">Shape2SAS</a>, or use this <a href="Isim.dat"> example data</a>.<br>
	Go to <a href="https://somo.chem.utk.edu/bayesapp/" target="_blank">BayesApp</a>, which is a web-application for generating p(r) for SAXS and SANS data.<br>
	Upload your simulated data, and press submit. <br>
	The program shows the calculated p(r), and a fit to the data, which was used to generate this p(r).
	<img src="BayesApp_sphere_pr.png" style="width:500px"/><br>
	<img src="BayesApp_sphere_Iq.png" style="width:500px"/><br>
	Give a rough estimate of the maximum distance (this does not have to be accurate) and press submit again. Giving an estimate of the maximum distance is optional, but makes BayesApp faster and more robust. Notice the computation time decreased.
    Go to the SAS biological data bank <a href="https://www.sasbdb.org" target="_blank">(SASBDB)</a>, which is a database for SAXS and SANS data. Download the SAXS data of the protein Xylanase <a href="https://www.sasbdb.org/data/SASDPS4/" target="_blank">(SASBDB entry: SASDPS4)</a>: <a href="SASDPS4.dat" target="_blank">SASDPS4.dat</a>.
	Use <a href="https://somo.chem.utk.edu/bayesapp/" target="_blank">BayesApp</a> to calculate the p(r). To increase speed and robustness, provide a rough estimate of the maximum distance - it does not have to be precise. <br> 
	Comment on the resulting p(r). Notice that the p(r) looks like the p(r) from a sphere, meaning the protein is globular (approximately spherical). See the actual shape of the protein in the <a href="https://www.sasbdb.org/data/SASDPS4/" target="_blank">SASBDB entry</a>.<br>
	Now, do the same for an elongated protein, <a href="https://www.sasbdb.org/data/SASDTE2/" target="_blank">SASBDB entry: SASDTE2</a>. <br>
	Notice how the p(r) is closer to that of a cylinder or elongated ellipsoid. This way, by looking at the p(r), one can get an idea of the shape of the particles without model fitting. 
	</p>

<h4>Part 3: Inhomogeneous particles</h4>
	<p>
	The p(r) is a contrast-weighted pair distribution (contrast = &Delta;SLD = excess scattering length density). I.e. each bin in the distribution is the weighted sum of all pairs with a given distance.
	Therefore, if a pair of scatterers have contrasts with the same sign, then they contribute positively, but if the signs are opposite, then their contribution to the p(r) is negative. This means that the p(r) can have negative values.<br>
	Go to <a href="https://somo.chem.utk.edu/shape2sas/" target="_blank">Shape2SAS</a>, and simulate a core-shell spherical particle with inner radius 30 Å and outer radius 40 Å and with core &Delta;SLD of -1 and shell &Delta;SLD of +1
	<img src="SasView_CoreShell1.png" style="width:1000px"/><br>
	<img src="SasView_CoreShell2.png" style="width:1000px"/><br>
	<ol>Negative contribution comes from scattering pairs with &Delta;SLDs having opposite signs. Likewise, positive contributions comes from pair having the same sign (either both positive or both negative &Delta;SLD). Using this information, consider:
		<li>What scattering pairs in the core-shell particle does the negative part of the p(r) represent?</li>
		<li>Why are pair distributions (including this one) positive as small values of r?</li>
		<li>Why is this p(r) positive at larger r?</li>
	</ol><a href="answers.html"target="_blank">Answers</a>.
	</p>
	<!-- The forward scattering I(0) is about 0. How does that relate to the p(r)? (<a href="hint1.html"target="_blank">Hint</a>) -->
	<p>
	Download the simulated data <a href="Isim_coreshell.dat" target="_blank">(example data)</a> and upload it to <a href="https://somo.chem.utk.edu/bayesapp/" target="_blank">BayesApp</a>. Give an estimate of the maximum distance and press Submit.<br>
	By default, the p(r) is constraint to be positive. (Transformation: Debye). Now, try to rerun with Tranform: Negative (i.e. p(r) can be negative.) Is the result better?
	Compare with the true p(r), which was simulated in <a href="https://somo.chem.utk.edu/shape2sas/" target="_blank">Shape2SAS</a>.<br>
	Note that inhomogeneous particles do not always give rise to p(r) with negative contribution. Try, for example, simulating a core-shell spherical particle with core radius of 20 and &Delta;SLD of -1 and shell radius of 40 and &Delta;SLD of +1.
	<img src="SasView_CoreShell3.png" style="width:1000px"/><br>
	In this case, the negative contribution from core-shell scatterer pairs is cancelled out by positive contributions from shell-shell scatterer pairs having the same distance. 
	</p>

<h4>Part 4: Interparticle interactions</h4>
	<p>
	Negative contribution in the p(r) may also stem from interparticle interactions. This can appear if the concentration is high. <br>
	Go to <a href="https://somo.chem.utk.edu/shape2sas/" target="_blank">Shape2SAS</a>, and simulate an ellipsoid with axes 40,40 and 60 Å. Add interparticle interaction, modelled with a hard-sphere structure factor with hard sphere radius of 50 and volume fraction 0.1. 
	<img src="Shape2SAS_HS1.png" style="width:1000px"/><br>
	<img src="Shape2SAS_HS2.png" style="width:1000px"/><br>
	The p(r) in Shape2SAS is calculated before the structure factor. <br>
	Download the<a href="HS.dat">data</a> data and generate the p(r) using <a href="https://somo.chem.utk.edu/bayesapp/" target="_blank">BayesApp</a>. Try with positive restraint (Transformation: Debye) or without (Transformation: Negative).<br>
	</p>

<h4>Part 5: Protein aggregation</h4>
	<p>
	Protein aggregation in a sample may be detected using p(r) - in reveals itself as a "tail" towards high values of r. In this case, the p(r) can be considered a linear combination of the p(r) of a non-agregated particle with a small d<sub>max</sub>, and the p(r) of an aggregate with a large d<sub>max</sub>.
	Go to <a href="https://somo.chem.utk.edu/shape2sas/" target="_blank">Shape2SAS</a>, and simulate a 50 Å sphere (or any other object) with aggregate structure factor (set fraction to 0.005, i.e. 0.5% of all particles are aggregated and particles per aggregate to 40).<br>
	OBS: The p(r) shown in Shape2SAS is for the spheres without the structure factor, but the simulated data contains the structure factor.<br>
	Download the data <a href="Isim_sphere_aggregate.dat">(example data)</a>, and calculate the p(r) with <a href="https://somo.chem.utk.edu/bayesapp/" target="_blank">BayesApp</a>. (The default number of points in p(r) may need to be increased). Notice the "tail":
	<img src="BayesApp_agg_pr.png" style="width:500px"/><br>
	<img src="BayesApp_agg_Iq.png" style="width:00px"/>
	</p>

<h4>Challenges</h4>
	<ol>
		<li>The protein bovine serum albumin (BSA) was measured with SAXS. Data: <a href="bsa_hc_030.dat" target="_blank">bsa_hc_030.dat</a>. BSA is a common blood protein. The sample was measure with SAXS at relatively high concentration. Generate the p(r) - what does it tell you?</li>
		<li>A sample of discoidal particles (diameter ca 5 nm, as estimated from <a href="https://www.urmc.rochester.edu/research/electron-microscope/services/protocols-techniques/negative-staining-electron-microscopy.aspx" target="_blank">negative stain electron microscopy</a>) was measured in SAXS at neutral pH (<a href="SAXS_neutral_pH.dat">neutral pH data</a>) and pH 5.0 (<a href="SAXS_low_pH.dat">low pH data</a>). Using the p(r), describe what happens?</li>
		<li>The protein <a href="https://www.rcsb.org/structure/4u2p" target="_blank">GluA2</a> (glutamine receptor - important for neuronal communication) was measured with SANS. Data: <a href="SASDD26.dat" target="_blank">SASDD26.dat</a>. You have calculated the theoretical d<sub>max</sub> to be around 200 Å. From the p(r), what can you tell about the sample?</li>
	</ol>
	
<h4>Feedback</h4>
	<p>You can help us improve the tutorials by filling out this short <a href="https://forms.gle/zEKzW4sbuRiSa23c8" target="_blank">feedback form</a> (it takes 2 min).</p>

<h4><a href="../index.html">Home</a></h4>

<p> Frontpage image from <a href="https://nbi.ku.dk/english/theses/phd-theses/phd_theses_2018/andreas_haahr_larsen/Thesis_AndreasHLarsenSept2018.pdf" target="_blank">Larsen 2018 (PhD Thesis)</a></p>

<!-- end inner -->
</div>
	
<!-- end main -->
</div>

<!-- end wrapper -->
</div>
	
<!-- Scripts -->
<script src="../assets/js/jquery.min.js"></script>
<script src="../assets/js/browser.min.js"></script>
<script src="../assets/js/breakpoints.min.js"></script>
<script src="../assets/js/util.js"></script>
<script src="../assets/js/main.js"></script>
</body>	
</html>
